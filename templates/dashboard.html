<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Dashboard ki·ªÉm k√™</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body {
    background-color: #f4f6f9;
}
.card {
    border-radius: 14px;
}
.progress {
    height: 22px;
}
</style>
</head>

<body>

<!-- ================= NAVBAR ================= -->
<nav class="navbar navbar-dark bg-primary px-3">
    <span class="navbar-brand fw-bold">üìã KI·ªÇM K√ä TOTO</span>
    <a href="/logout" class="btn btn-light btn-sm">Logout</a>
</nav>

<div class="container my-4">

<!-- ================================================= -->
<!-- ================= USER VIEW ==================== -->
<!-- ================================================= -->
{% if role == "user" %}

<div class="card mb-4">
    <div class="card-header bg-info text-white fw-bold">
        üë§ Th√¥ng tin nh√¢n vi√™n
    </div>
    <div class="card-body">
        <div class="row g-2">
            <div class="col-md-6"><b>M√£ NV:</b> {{ nv.Ma_NV }}</div>
            <div class="col-md-6"><b>H·ªç t√™n:</b> {{ nv.Ho_ten }}</div>
            <div class="col-md-6"><b>BP:</b> {{ nv.BP }}</div>
            <div class="col-md-6"><b>B·ªô ph·∫≠n KK:</b> {{ nv.Bo_phan_KK }}</div>
            <div class="col-md-6"><b>Lo·∫°i h√†ng:</b> {{ nv.Loai_hang }}</div>
            <div class="col-md-6"><b>Nh√≥m:</b> {{ nv.Nhom }}</div>
            <div class="col-md-6"><b>ƒê·ªôi:</b> {{ nv.Doi }}</div>
            <div class="col-md-6"><b>Vai tr√≤:</b> {{ nv.Vai_tro }}</div>
            <div class="col-12"><b>SƒêT:</b> {{ nv.SDT }}</div>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-header bg-warning fw-bold">
        üìù Tr·∫°ng th√°i ki·ªÉm k√™
    </div>
    <div class="card-body">

        <p>
            <b>Tr·∫°ng th√°i hi·ªán t·∫°i:</b>
            <span class="badge bg-secondary">{{ trang_thai }}</span>
        </p>

        <form method="POST" action="/user/checkin">
            <label class="form-label fw-bold">C·∫≠p nh·∫≠t tr·∫°ng th√°i</label>

            <select name="trang_thai" class="form-select mb-3">
                <option value="ƒêang KK">ƒêang KK</option>
                <option value="ƒêang check ch√©o">ƒêang check ch√©o</option>
                <option value="K·∫øt th√∫c KK">K·∫øt th√∫c KK</option>
            </select>

            <button class="btn btn-primary w-100">
                üíæ L∆∞u tr·∫°ng th√°i
            </button>
        </form>

    </div>
</div>

{% endif %}

<!-- ================================================= -->
<!-- ================= ADMIN VIEW =================== -->
<!-- ================================================= -->
{% if role == "admin" %}

<div class="card mb-4">
    <div class="card-header bg-dark text-white fw-bold">
        üìä KI·ªÇM K√ä THEO B·ªò PH·∫¨N
    </div>

    <div class="card-body table-responsive">

        <!-- ===== EXPORT ALL ===== -->
        <div class="d-flex justify-content-end mb-3">
            <a href="/admin/export_all" class="btn btn-success">
                üìä Xu·∫•t to√†n b·ªô Excel
            </a>
        </div>

        <table class="table table-bordered align-middle text-center">
            <thead class="table-secondary">
                <tr>
                    <th>B·ªô ph·∫≠n</th>
                    <th>T·ªïng NV</th>
                    <th class="text-warning">ƒêang KK</th>
                    <th class="text-info">Check ch√©o</th>
                    <th class="text-success">K·∫øt th√∫c</th>
                    <th>Ti·∫øn ƒë·ªô</th>
                    <th>Xu·∫•t Excel</th>
                </tr>
            </thead>

            <tbody>
            {% for r in stat %}
                <tr>
                    <td class="fw-bold">{{ r.Bo_phan_KK }}</td>
                    <td>{{ r.Tong }}</td>
                    <td>{{ r.Dang_KK }}</td>
                    <td>{{ r.Dang_cheo }}</td>
                    <td>{{ r.Ket_thuc }}</td>
                    <td style="min-width:160px">
                        <div class="progress">
                            <div class="progress-bar bg-success"
                                 style="width: {{ r.Tien_do }}%">
                                {{ r.Tien_do }}%
                            </div>
                        </div>
                    </td>
                    <td>
                        <a href="/admin/export/{{ r.Bo_phan_KK }}"
                           class="btn btn-sm btn-outline-primary">
                            üì• Excel
                        </a>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>

{% endif %}

</div>

</body>
</html>




